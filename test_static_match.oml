name : /test/static_match_cond
---
static {
    localhost = chars("localhost");
    attack_ip = chars("attack_ip");
    status_ok = chars("ok");
    status_err = chars("error");
    ip_127     = ip(127.0.0.1);
    dgt_200    = digit(200);
    dgt_400    = digit(400);
}

sent_bytes:digit = take(sent_bytes) ;
target_status_code:digit = take(target_status_code) ;
elb_status_code:digit = take(elb_status_code) ;

extends : obj = object {
    ssl_cipher = read(ssl_cipher);
    ssl_protocol = read(ssl_protocol);
};

# Test static symbol in match conditions
match_chars = match read(option:[wp_src_ip]) {
    ip_127 =>  localhost;
    !ip_127 => attack_ip;
};

match_digit = match read(option:[http_status]) {
    dgt_200 => status_ok;
    dgt_400 => status_err;
};

# Test in range with static symbols
status_level = match read(option:[status_code]) {
    in (dgt_200, dgt_400) => chars(client_error);
    _ => chars(other);
};
